[SERVICE]
    Parsers_File /etc/fluent-bit/parsers.conf

[INPUT]
    Name        tail
    Path        /var/log/fibonacci/frontend.*
    Tag         frontend_logs
    Parser      rust_tracing_json
    DB          /var/lib/fluent-bit/frontend_logs.db
    Mem_Buf_Limit 5MB
    Refresh_Interval 10

[INPUT]
    Name        tail
    Path        /var/log/nginx/access.log
    Tag         nginx_access
    Parser      nginx_access_json
    DB          /var/lib/fluent-bit/nginx_access.db
    Mem_Buf_Limit 5MB
    Refresh_Interval 10

[INPUT]
    Name        tail
    Path        /var/log/nginx/error.log
    Tag         nginx_error
    Parser      nginx_error
    DB          /var/lib/fluent-bit/nginx_error.db
    Mem_Buf_Limit 5MB
    Refresh_Interval 10

# For the nginx access log, apply the nginx request parser to the 'request' field
# so we end up with fields 'method', 'path' and 'protocol':
[FILTER]
    Name        parser
    Match       nginx_access
    Key_Name    request
    Parser      nginx_request_parser
    # Preserve original fields:
    Reserve_Data On

[OUTPUT]
    Name            opensearch
    Match           *
    Host            192.168.6.33
    Port            9200
    # Needed to prevent 'Action/metadata line [1] contains an unknown parameter [_type]':
    Suppress_Type_Name On
    # With Logstash_Format On fluent-bit will generate a separate index for each day.
    Logstash_Format On
    Logstash_Prefix frontend
    # OpenSearch requires HTTPS:
    tls             on
    # But uses a self-signed certificate, so don't check it:
    tls.verify      off
    # Credentials to use to upload documents:
    http_user       admin
    http_passwd     T!mberW0lf#92
